{"ast":null,"code":"var _s = $RefreshSig$();\nimport { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, updateProfile, signOut } from \"firebase/auth\";\nimport { useState, useEffect } from \"react\";\nexport const useAuthentication = () => {\n  _s();\n  const [error, setError] = useState(null);\n  const [loading, setLoading] = useState(null);\n\n  // deal with memory leak\n  const [cancelled, setCancelled] = useState(false);\n  const auth = getAuth();\n  function checkIfIsCancelled() {\n    if (cancelled) {\n      return;\n    }\n  }\n  const createUser = async data => {\n    checkIfIsCancelled();\n    setLoading(true);\n    try {\n      const {\n        user\n      } = await createUserWithEmailAndPassword(auth, data.email, data.password);\n      await updateProfile(user, {\n        displayName: data.displayName\n      });\n      return user;\n    } catch (error) {\n      console.log(error.message);\n      console.log(typeof error.message);\n      let systemErrorMessage;\n      if (error.message.includes(\"Password\")) {\n        systemErrorMessage = \"A senha precisa conter pelo menos 6 caracteres.\";\n      } else if (error.message.includes(\"email-already\")) {\n        systemErrorMessage = \"E-mail já cadastrado.\";\n      } else {\n        systemErrorMessage = \"Ocorreu um erro, por favor tenta mais tarde.\";\n      }\n      setError(systemErrorMessage);\n    }\n    setLoading(false);\n  };\n  const logout = () => {\n    checkIfIsCancelled();\n    signOut(auth);\n  };\n  const login = async data => {\n    checkIfIsCancelled();\n    setLoading(true);\n    setError(false);\n    try {\n      await signInWithEmailAndPassword(auth, data.email, data.password);\n    } catch (error) {\n      console.log(error.message);\n      console.log(typeof error.message);\n      console.log(error.message.includes(\"user-not\"));\n      let systemErrorMessage;\n      if (error.message.includes(\"user-not-found\")) {\n        systemErrorMessage = \"Usuário não encontrado.\";\n      } else if (error.message.includes(\"wrong-password\")) {\n        systemErrorMessage = \"Senha incorreta.\";\n      } else {\n        systemErrorMessage = \"Ocorreu um erro, por favor tenta mais tarde.\";\n      }\n      console.log(systemErrorMessage);\n      setError(systemErrorMessage);\n    }\n    console.log(error);\n    setLoading(false);\n  };\n  useEffect(() => {\n    return () => setCancelled(true);\n  }, []);\n  return {\n    auth,\n    createUser,\n    error,\n    logout,\n    login,\n    loading\n  };\n};\n_s(useAuthentication, \"xO6KHeiqqCsOzooKHe/mUZTZLjs=\");","map":{"version":3,"names":["getAuth","createUserWithEmailAndPassword","signInWithEmailAndPassword","updateProfile","signOut","useState","useEffect","useAuthentication","_s","error","setError","loading","setLoading","cancelled","setCancelled","auth","checkIfIsCancelled","createUser","data","user","email","password","displayName","console","log","message","systemErrorMessage","includes","logout","login"],"sources":["/Users/wagnerparisoto/Documents/fontes/estudos/ReactZeroAMaestria/10_MINIBLOG/miniblog/src/hooks/useAuthentication.js"],"sourcesContent":["import {\n    getAuth,\n    createUserWithEmailAndPassword,\n    signInWithEmailAndPassword,\n    updateProfile,\n    signOut,\n  } from \"firebase/auth\";\n  \n  import { useState, useEffect } from \"react\";\n  \n  export const useAuthentication = () => {\n    const [error, setError] = useState(null);\n    const [loading, setLoading] = useState(null);\n  \n    // deal with memory leak\n    const [cancelled, setCancelled] = useState(false);\n  \n    const auth = getAuth();\n  \n    function checkIfIsCancelled() {\n      if (cancelled) {\n        return;\n      }\n    }\n  \n    const createUser = async (data) => {\n      checkIfIsCancelled();\n  \n      setLoading(true);\n  \n      try {\n        const { user } = await createUserWithEmailAndPassword(\n          auth,\n          data.email,\n          data.password\n        );\n  \n        await updateProfile(user, {\n          displayName: data.displayName,\n        });\n  \n        return user;\n      } catch (error) {\n        console.log(error.message);\n        console.log(typeof error.message);\n  \n        let systemErrorMessage;\n  \n        if (error.message.includes(\"Password\")) {\n          systemErrorMessage = \"A senha precisa conter pelo menos 6 caracteres.\";\n        } else if (error.message.includes(\"email-already\")) {\n          systemErrorMessage = \"E-mail já cadastrado.\";\n        } else {\n          systemErrorMessage = \"Ocorreu um erro, por favor tenta mais tarde.\";\n        }\n  \n        setError(systemErrorMessage);\n      }\n  \n      setLoading(false);\n    };\n  \n    const logout = () => {\n      checkIfIsCancelled();\n  \n      signOut(auth);\n    };\n  \n    const login = async (data) => {\n      checkIfIsCancelled();\n  \n      setLoading(true);\n      setError(false);\n  \n      try {\n        await signInWithEmailAndPassword(auth, data.email, data.password);\n      } catch (error) {\n        console.log(error.message);\n        console.log(typeof error.message);\n        console.log(error.message.includes(\"user-not\"));\n  \n        let systemErrorMessage;\n  \n        if (error.message.includes(\"user-not-found\")) {\n          systemErrorMessage = \"Usuário não encontrado.\";\n        } else if (error.message.includes(\"wrong-password\")) {\n          systemErrorMessage = \"Senha incorreta.\";\n        } else {\n          systemErrorMessage = \"Ocorreu um erro, por favor tenta mais tarde.\";\n        }\n  \n        console.log(systemErrorMessage);\n  \n        setError(systemErrorMessage);\n      }\n  \n      console.log(error);\n  \n      setLoading(false);\n    };\n  \n    useEffect(() => {\n      return () => setCancelled(true);\n    }, []);\n  \n    return {\n      auth,\n      createUser,\n      error,\n      logout,\n      login,\n      loading,\n    };\n  };"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}